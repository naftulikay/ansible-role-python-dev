---
- name: setup
  hosts: localhost
  vars:
    container_user: vagrant
  tasks:
    - name: create user
      user: name={{ container_user }} comment="Container User" shell=/bin/bash state=present

- name: build
  hosts: localhost
  roles:
    - role: python-dev
      python_user: vagrant
      python_version: 2.7.13

- name: test
  hosts: localhost
  vars: {}
  roles:
    - role: degoss
      degoss_no_clean: true
      goss_file: goss.yml
      goss_addtl_dirs: [goss.d/]
      goss_env_vars:
        libffi_package: "{{ python_dev_packages.libffi }}"
        libxml2_package: "{{ python_dev_packages.libxml2 }}"
        libxslt_package: "{{ python_dev_packages.libxslt }}"
        libyaml_package: "{{ python_dev_packages.libyaml }}"
        python_user: vagrant
        python_version: 2.7.13
        pyenv_executable: /home/vagrant/.pyenv/bin/pyenv
